(function(){this.FormBase=function(){function n(){this.submitting=ko.observable(!1);this.success=ko.observable(!1);this.errors=ko.observableArray([]);this.errorMessage=ko.computed(function(n){return function(){return n.errors().join("\n")}}(this));this.fail=ko.computed(function(n){return function(){return n.errors().length>0}}(this));this.clearMessages=function(n){return function(){return n.success(!1),n.errors([])}}(this);this.editing=ko.observable(!0);this.view=function(n){return function(){return n.editing(!1)}}(this);this.edit=function(n){return function(){return n.editing(!0),n.clearMessages()}}(this);this.submit=function(n){return function(t,i,r){return n.submitting(!0),n.clearMessages(),$.postJson(t,i||{}).done(function(){return n.success(!0),r!=null?r():void 0}).fail(function(t){var u,i,r,e,f;if(i=JSON.parse(t.responseText),i.unexpected)return n.errors(["Unexpected error occurred."]);for(f=i.errors,r=0,e=f.length;r<e;r++)u=f[r],n.errors.push(""+n.fieldTitle(u.fieldName)+": "+u.message);if(i.errors.length===0&&i.message)return n.errors.push(i.message)}).always(function(){return n.submitting(!1)})}}(this)}return n.prototype.fieldTitle=function(n){return n.replace(/([A-Z])/g," $1").trim()},n}()}).call(this);