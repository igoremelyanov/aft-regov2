(function(){var t,n=function(n,t){return function(){return n.apply(t,arguments)}};t=function(){function t(){this.submitBonus=n(this.submitBonus,this);this.setAmount=n(this.setAmount,this);this.onErrorHandler=n(this.onErrorHandler,this);this.validateBonusCode=n(this.validateBonusCode,this);this.amount=ko.observable($("#hidden-amount").val()).extend({required:!0,validatable:!0});this.bonuscode=ko.observable().extend({validatable:!0});this.selectedBonusId=ko.observable();this.isEnabled=ko.observable(!1);this.submitDisabled=ko.observable(!1);this.buttonTitle=ko.computed(function(n){return function(){return n.selectedBonusId()?"DEPOSIT AND GET BONUS":"DEPOSIT"}}(this));this.selectBonus=function(n){return function(t,i){return i>n.amount()?!1:n.selectedBonusId()===t?n.selectedBonusId(""):n.selectedBonusId(t)}}(this);this.onSubmit=function(n){return function(){var i,t;return isNaN(n.amount())&&(t=n.amount,t)?(t.error="You can enter only numbers",t.__valid__(!1),!1):(i={amount:n.amount()},n.validate("/api/validateonlinedepositamount",i,function(){var t;return t=n.createOnlineDepositObject(n.selectedBonusId()),t.submitOnlineDeposit()}))}}(this);this.createOnlineDepositObject=function(n){return function(t){var i=new OnlineDepositModel("/home/registerstep4","",function(){return popupAlert("Error occured.","Contact an administrator.")});i.onlineAmount(n.amount());return i.onlineDepositBonusId(t)}}(this);this.validate=function(n){return function(t,i,r){return $.postJson(t,i).done(function(t){return t.hasError?n.onErrorHandler(t):r(t)}).fail(function(t){return n.onErrorHandler(t)})}}(this)}var i;return t.prototype.validateBonusCode=function(){return $.postJson("/api/ValidateFirstDepositBonus",{bonusCode:this.bonuscode(),depositAmount:this.amount()}).done(function(n){return function(t){var i;return t.isValid?redirect("/home/registerstep2?bonusCode="+t.bonus.code+"&amount="+n.amount()):(i=n.bonuscode,i)?(i.error=t.errors[0],i.__valid__(!1)):void 0}}(this))},t.prototype.onErrorHandler=function(n){var t,i;return t=this.amount,i=n.errors.amount,t?(t.error=i,t.__valid__(!1)):void 0},t.prototype.setAmount=function(n){return this.amount(n)},t.prototype.submitBonus=function(){},i=new t,ko.applyBindings(i,$("#register2-wrapper")[0]),t}()}).call(this);