(function(){var n;n=function(){function n(){n.__super__.constructor.apply(this,arguments);this.username=ko.observable("").extend({validator:!0});this.password=ko.observable("").extend({validator:!0});this.captcha=ko.observable("").extend({validator:!0});this.hasErrors=ko.observable(!1);this.messages=ko.observableArray([]);this.requestInProgress=ko.observable(!1);this.signIn=function(){return this.clearValidations(),this.requestInProgress(!0),$.postJson("/api/Login",{UserName:self.username(),Password:self.password()}).done(function(){return camelCaseProperties(response),redirect("/Home/PlayerProfile")}).fail(function(n){var i,t;return t=JSON.parse(n.responseText),camelCaseProperties(t),this.messages([]),this.hasErrors(!0),t.unexpected?this.messages.push("Unexpected error occurred."):(i=t.errors,i&&i.length?i.forEach(function(n){var t,i;return t="app:apiResponseCodes."+n.message,n.params.length===0?this.messages.push($.i18n.t(t)):(i={},n.params.forEach(function(n){return i[n.name]=n.value}),this.messages.push($.i18n.t(t,i)))}):t.message&&this.messages.push(t.message)),$("#login-messages").modal()}).always(function(){return this.requestInProgress(!1)})};this.clearValidations=function(){return this.username.setError(!1),this.password.setError(!1)};this.toRegister=function(){return redirect("/Home/Register")};this.logout=function(){return $.postJson("/api/Logout").done(function(){return redirect("/")}).fail(function(){return this.messages([]),this.messages.push("Unexpected error occurred."),$("#login-messages").modal()})};this.resetPasswordUsername=ko.observable().extend({validator:!0});this.resetPasswordEmail=ko.observable().extend({validator:!0});this.resetPassword(function(){return $.postJson("api/ResetPassword",{Username:self.resetPasswordUsername(),Email:self.resetPasswordEmail()}).success(function(){return $("#forgotPassword .step-1").hide().next().fadeIn(),console.log("Password Changed")}).fail(function(n){var i,t;return t=JSON.parse(n.responseText),i=t.message.charAt(0).toLowerCase()+t.message.slice(1),this.messages([]),this.messages.push($.t("login.validationMessages."+i)),$("#login-messages").modal()})});this.hideResetPassword(function(){return $("#forgotPassword").modal("hide")});$(document).ready(function(){return $("#forgotPassword").on("show.bs.modal",function(){return $(".modal-password-step:first").show().next().hide()})})}return n}();ko.extenders.validator=function(n){return n.hasError=ko.observable(!1),n.messages=ko.observableArray([]),n.error=ko.observable(),n.errorMessage=ko.observable(),n.setError=function(t){return n.hasError(t),t?void 0:n.messages([])},n.addErrorMessage=function(t){return n.messages.push(t)},n};ko.applyBindings(new LoginModel,document.getElementById("login-wrapper"));ko.applyBindings(new LoginModel,document.getElementById("modal-login"))}).call(this);