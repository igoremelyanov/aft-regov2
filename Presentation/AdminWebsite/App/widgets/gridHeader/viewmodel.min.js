(function(){define(function(n){var t;return t=n("controls/column-selection-dialog"),function(){function n(){$.extend(this,ko.mapping.fromJS({filtersExpanded:!1,filters:[],buttons:[]}));this.showButtons=ko.computed(function(n){return function(){return n.buttons().length>0}}(this))}return n.prototype.activate=function(n){var i,r,u;return this.parentContext=n.context,this.filters(n.filters),n.selectColumns?(u=function(n){return function(){return new t(n.grid[0],n.filters,n.columnStorage,n.hiddenColumns).show().then(function(t){if(t!=null)return n.hiddenColumns=t.slice(0)})}}(this),i=function(n){return function(){return localStorage.setItem(n.columnStorage,""),n.hiddenColumns=null,n.grid[0].showColumns(n.filters().map(function(n){return n[0]}))}}(this),r=function(n){return function(){return n.hiddenColumns?localStorage.setItem(n.columnStorage,JSON.stringify(n.hiddenColumns)):localStorage.removeItem(n.columnStorage)}}(this),this.buttons(n.buttons.concat([{name:"selectColumns",click:u,text:"app:report.common.selectColumns",icon:"columns"},{name:"clearColumns",click:i,text:"app:report.common.clearColumns",icon:"eye"},{name:"saveColumns",click:r,text:"app:report.common.saveColumns",icon:"save"}]))):this.buttons(n.buttons)},n.prototype.attached=function(n){var t;return this.grid=findGrid(n),t=$(n).find("form").addBack("form").first(),$(t).submit(function(n){return function(){return n.grid.trigger("reload"),!1}}(this)),$(".input-search-wrap i",t).click(function(n){return function(){return n.parentContext.search(""),!1}}(this)),this.columnStorage=$(n).parents("[data-view]").first().attr("data-view").replace("/","_"),this.hiddenColumns=JSON.parse(localStorage.getItem(this.columnStorage)||"[]"),this.hiddenColumns!=null?this.grid[0].hideColumns(this.hiddenColumns):void 0},n.prototype.showFilter=function(){return this.filtersExpanded(!0)},n.prototype.hideFilter=function(){return this.filtersExpanded(!1)},n}()})}).call(this);