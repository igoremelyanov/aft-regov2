(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["nav","i18next","security/security","dateTimePicker","EntityFormUtil","shell"],function(t,i,r,u,f,e){return function(){function r(){this.save=n(this.save,this);this.fillViewModel=n(this.fillViewModel,this);this.load=n(this.load,this);this.loadConfiguration=n(this.loadConfiguration,this);this.activate=n(this.activate,this);this.loadBrands=n(this.loadBrands,this);this.loadLicensees=n(this.loadLicensees,this);var t;this.message=ko.observable("");this.messageClass=ko.observable;this.form=new f.Form(this);this.isReadOnly=ko.observable(!1);f.setupLicenseeField2(this);f.setupBrandField2(this);this.dummyObservable=ko.observable();this.form.makeField("id",ko.observable()).lockValue(!0);this.form.makeField("deviceIdExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("firstNameExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("lastNameExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("fullNameExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("usernameExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("addressExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("signUpIpExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("mobilePhoneExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("dateOfBirthExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("emailAddressExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("zipCodeExactScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("deviceIdFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("firstNameFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("lastNameFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("fullNameFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("usernameFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("addressFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("signUpIpFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("mobilePhoneFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("dateOfBirthFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("emailAddressFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("zipCodeFuzzyScore",ko.observable().extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("noHandlingScoreMax",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("noHandlingScoreMin",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3,validation:{validator:function(n){return function(t){return parseInt(n.fields.noHandlingScoreMax())>=parseInt(t)}}(this),message:"'From' value should be less or equals to 'To'."}}));this.form.makeField("noHandlingSystemAction",ko.observable().extend({required:!0}));this.form.makeField("noHandlingDescr",ko.observable().extend({required:!0}));this.form.makeField("recheckScoreMax",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("recheckScoreMin",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3,validation:{validator:function(n){return function(t){return parseInt(n.fields.recheckScoreMax())>=parseInt(t)}}(this),message:"'From' value should be less or equals to 'To'."}}));this.form.makeField("recheckSystemAction",ko.observable().extend({required:!0}));this.form.makeField("recheckDescr",ko.observable().extend({required:!0}));this.form.makeField("fraudulentScoreMax",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3}));this.form.makeField("fraudulentScoreMin",ko.observable(0).extend({required:!0,formatInt:{allowNegative:!1,allowEmpty:!1},maxLength:3,validation:{validator:function(n){return function(t){return parseInt(n.fields.fraudulentScoreMax())>=parseInt(t)}}(this),message:"'From' value should be less or equals to 'To'."}}));this.form.makeField("fraudulentSystemAction",ko.observable().extend({required:!0}));this.form.makeField("fraudulentDescr",ko.observable().extend({required:!0}));t=["licensee","brand","deviceIdExactScore","firstNameExactScore","lastNameExactScore","fullNameExactScore","usernameExactScore","addressExactScore","signUpIpExactScore","mobilePhoneExactScore","dateOfBirthExactScore","emailAddressExactScore","zipCodeExactScore","deviceIdFuzzyScore","firstNameFuzzyScore","lastNameFuzzyScore","fullNameFuzzyScore","usernameFuzzyScore","addressFuzzyScore","signUpIpFuzzyScore","mobilePhoneFuzzyScore","dateOfBirthFuzzyScore","emailAddressFuzzyScore","zipCodeFuzzyScore","noHandlingScoreMin","noHandlingScoreMax","noHandlingSystemAction","noHandlingDescr","recheckScoreMin","recheckScoreMax","recheckSystemAction","recheckDescr","fraudulentScoreMin","fraudulentScoreMax","fraudulentSystemAction","fraudulentDescr"];this.actions=ko.observableArray([{text:"No Action",value:0},{text:"Freeze Account",value:1},{text:"Disable Bonus",value:2},{text:"Deactivate",value:3}]);this.totalExactScore=ko.computed(function(n){return function(){var i,r,u,f,e,o,s,h,t,c,l,a;return t=0,u=parseInt(n.fields.deviceIdExactScore()),isNaN(u)||(t+=u),e=parseInt(n.fields.firstNameExactScore()),isNaN(e)||(t+=e),s=parseInt(n.fields.lastNameExactScore()),isNaN(s)||(t+=s),o=parseInt(n.fields.fullNameExactScore()),isNaN(o)||(t+=o),l=parseInt(n.fields.usernameExactScore()),isNaN(l)||(t+=l),i=parseInt(n.fields.addressExactScore()),isNaN(i)||(t+=i),c=parseInt(n.fields.signUpIpExactScore()),isNaN(c)||(t+=c),h=parseInt(n.fields.mobilePhoneExactScore()),isNaN(h)||(t+=h),r=parseInt(n.fields.dateOfBirthExactScore()),isNaN(r)||(t+=r),f=parseInt(n.fields.emailAddressExactScore()),isNaN(f)||(t+=f),a=parseInt(n.fields.zipCodeExactScore()),isNaN(a)||(t+=a),t}}(this));this.totalExactScore.subscribe(function(n){return function(t){return n.fields.fraudulentScoreMax(t)}}(this));this.totalFuzzyScore=ko.computed(function(n){return function(){var i,r,u,f,e,o,s,h,t,c,l,a;return t=0,u=parseInt(n.fields.deviceIdFuzzyScore()),isNaN(u)||(t+=u),e=parseInt(n.fields.firstNameFuzzyScore()),isNaN(e)||(t+=e),s=parseInt(n.fields.lastNameFuzzyScore()),isNaN(s)||(t+=s),o=parseInt(n.fields.fullNameFuzzyScore()),isNaN(o)||(t+=o),l=parseInt(n.fields.usernameFuzzyScore()),isNaN(l)||(t+=l),i=parseInt(n.fields.addressFuzzyScore()),isNaN(i)||(t+=i),c=parseInt(n.fields.signUpIpFuzzyScore()),isNaN(c)||(t+=c),h=parseInt(n.fields.mobilePhoneFuzzyScore()),isNaN(h)||(t+=h),r=parseInt(n.fields.dateOfBirthFuzzyScore()),isNaN(r)||(t+=r),f=parseInt(n.fields.emailAddressFuzzyScore()),isNaN(f)||(t+=f),a=parseInt(n.fields.zipCodeFuzzyScore()),isNaN(a)||(t+=a),t}}(this));f.publishIds(this,"duplicate-",t);f.addCommonMembers(this);this.form.publishIsReadOnly(t);this.getLicenseesUrl=function(){return"Licensee/Licensees?useFilter=true"};this.getBrandsUrl=function(n){return function(){return"DuplicateMechanism/GetBrands?licensee="+n.form.fields.licensee.value().id+"&configId="+n.fields.id()}}(this);this.form.fields.licensee.value.subscribe(function(n){return function(){return f.loadBrands2(n.getBrandsUrl,n.form.fields.brand)}}(this));this.configuration=void 0}var u,o,s,h;return r.prototype.loadLicensees=function(n){var t,i;return t=f.getBrandLicenseeId(e),i=this.form.fields.licensee.options(),this.configuration&&(t=this.configuration.licensee),f.selectLicensee2(this.form.fields.licensee,t),f.loadBrands2(this.getBrandsUrl,this.form.fields.brand,function(t){return function(){return t.callCallback(n)}}(this))},r.prototype.loadBrands=function(n){var t;return t=this.configuration?this.configuration.brand:e.brand().id(),f.selectBrand2(this.form.fields.brand,t),this.callCallback(n)},s={gridBodyId:"duplicate-configurations-list",editUrl:"DuplicateMechanism/AddOrUpdate"},f.addCommonEditFunctions(r.prototype,s),r.prototype.activate=function(n){var t;return t=$.Deferred(),this.fields.id(n?n.id:null),this.submitted(n.editMode===!1),this.fields.id()?this.loadConfiguration(t):this.load(t),t.promise()},r.prototype.loadConfiguration=function(n){return $.ajax("DuplicateMechanism/GetById?id="+this.fields.id(),{success:function(t){return function(i){return t.configuration=i,t.fillViewModel(),t.load(n)}}(this)})},r.prototype.load=function(n){return f.loadLicensees2(this.getLicenseesUrl,this.form.fields.licensee,function(t){return function(){return t.loadLicensees(function(){return t.loadBrands(function(){return n.resolve()})})}}(this))},r.prototype.callCallback=function(n){if(n)return n()},r.prototype.serializeForm=function(){var n;return n=this.form.getDataObject(),JSON.stringify(n)},r.prototype.fillViewModel=function(){return this.fields.deviceIdExactScore(this.configuration.deviceIdExactScore),this.fields.firstNameExactScore(this.configuration.firstNameExactScore),this.fields.lastNameExactScore(this.configuration.lastNameExactScore),this.fields.fullNameExactScore(this.configuration.fullNameExactScore),this.fields.usernameExactScore(this.configuration.usernameExactScore),this.fields.addressExactScore(this.configuration.addressExactScore),this.fields.signUpIpExactScore(this.configuration.signUpIpExactScore),this.fields.mobilePhoneExactScore(this.configuration.mobilePhoneExactScore),this.fields.dateOfBirthExactScore(this.configuration.dateOfBirthExactScore),this.fields.emailAddressExactScore(this.configuration.emailAddressExactScore),this.fields.zipCodeExactScore(this.configuration.zipCodeExactScore),this.fields.deviceIdFuzzyScore(this.configuration.deviceIdFuzzyScore),this.fields.firstNameFuzzyScore(this.configuration.firstNameFuzzyScore),this.fields.lastNameFuzzyScore(this.configuration.lastNameFuzzyScore),this.fields.fullNameFuzzyScore(this.configuration.fullNameFuzzyScore),this.fields.usernameFuzzyScore(this.configuration.usernameFuzzyScore),this.fields.addressFuzzyScore(this.configuration.addressFuzzyScore),this.fields.signUpIpFuzzyScore(this.configuration.signUpIpFuzzyScore),this.fields.mobilePhoneFuzzyScore(this.configuration.mobilePhoneFuzzyScore),this.fields.dateOfBirthFuzzyScore(this.configuration.dateOfBirthFuzzyScore),this.fields.emailAddressFuzzyScore(this.configuration.emailAddressFuzzyScore),this.fields.zipCodeFuzzyScore(this.configuration.zipCodeFuzzyScore),this.fields.noHandlingScoreMin(this.configuration.noHandlingScoreMin),this.fields.noHandlingScoreMax(this.configuration.noHandlingScoreMax),this.fields.noHandlingSystemAction(this.configuration.noHandlingSystemAction),this.fields.noHandlingDescr(this.configuration.noHandlingDescr),this.fields.recheckScoreMin(this.configuration.recheckScoreMin),this.fields.recheckScoreMax(this.configuration.recheckScoreMax),this.fields.recheckSystemAction(this.configuration.recheckSystemAction),this.fields.recheckDescr(this.configuration.recheckDescr),this.fields.fraudulentScoreMin(this.configuration.fraudulentScoreMin),this.fields.fraudulentScoreMax(this.configuration.fraudulentScoreMax),this.fields.fraudulentSystemAction(this.configuration.fraudulentSystemAction),this.fields.fraudulentDescr(this.configuration.fraudulentDescr)},h=r.prototype.save,r.prototype.save=function(){var n;return n=!1,n?void 0:h.call(this)},o=r.prototype.handleSaveSuccess,r.prototype.handleSaveSuccess=function(n){return n.data=i.t("app:fraud.duplicateMechanism.messages."+n.data.code),o.call(this,n),t.title(i.t("app:fraud.duplicateMechanism.titles.view"))},u=r.prototype.handleSaveFailure,r.prototype.handleSaveFailure=function(n){return n.data=n.data,u.call(this,n),t.title(i.t("app:fraud.duplicateMechanism.titles.failure"))},r}()})}).call(this);