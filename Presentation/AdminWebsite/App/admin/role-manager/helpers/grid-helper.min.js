(function(){define(function(n){return function(){function t(){var t,i,f,e,r,o,u;for(e=function(n){var i,t,r,e,f,u,o;for(t=[],f=Math.random(),e={id:f,name:"Root"},t.push(e),u=0,o=n.length;u<o;u++)r=n[u],i=ko.utils.arrayFirst(t,function(n){return n.name===r.module}),i==null&&(i={id:Math.random(),name:r.module,module:"Root",parentId:f},t.push(i)),r.parentId=i.id,t.push(r);return t},f=n("security/security"),this.roles=e(f.operations()),console.log("transformed roles"),console.log(this.roles),u=this.roles,r=0,o=u.length;r<o;r++){for(t=u[r],t.sortkey=t.name.toLowerCase(),t.level=0,i=t;i.parentId!=null;)i=ko.utils.arrayFirst(this.roles,function(n){return n.id===i.parentId}),t.sortkey=i.name.toLowerCase()+"-"+t.sortkey,t.level++;t.expanded=!0}this.roles.sort(function(n,t){return n.sortkey<t.sortkey?-1:n.sortkey>t.sortkey?1:0})}return t.prototype.init=function(n){return this.grid=n,$(function(n){return function(){var u,f,r,t,o,h,i,e,c,s;for(u=[],o=0,h=new Date,s=$($("input[type=checkbox]",n.grid).get().reverse()),e=0,c=s.length;e<c;e++)f=s[e],r=$(f).is(":checked"),i=$(f).parents("tr"),typeof t!="undefined"&&t!==null&&(o=t),t=Number(i.find("td:eq(1)").text()),t<o&&(r=u[t+1],$(f).prop("checked",u[t+1]===!0),u.length=t),u[t]=function(){switch(u[t]){case void 0:return r;case!0:return r?!0:null;case!1:return r?null:!1;default:return null}}();return console.log((new Date-h)/1e3),$("input[type=checkbox]",n.grid).click(function(){var u,n;for(i=$(this).parents("tr"),t=i.find("td:eq(1)").text(),r=$(this).is(":checked"),n=[];(i=i.next()).length;){if(u=i.find("td:eq(1)").text(),u<=t)break;n.push($("input[type=checkbox]",i).prop("checked",r))}return n})}}(this))},t.prototype.getChecked=function(){var n;return n=[],console.log("getChecked"),$("input[type=checkbox]",this.grid).each(function(){var t;return t=$(this).parents("tr"),$(this).is(":checked")&&$("td:eq(1)",t).text()==="2"?n.push($("td:first",t).text()):void 0}),n},t.prototype.reload=function(){return this.grid.trigger("reload")},t.prototype.reset=function(){return $("input[type=checkbox]",this.grid).each(function(){return $(this).attr("checked",!1)})},t.prototype.filter=function(n){var i,t;return n=n.trim(),t=[],i=0,$($("input[type=checkbox]",this.grid).get().reverse()).each(function(){var a,u,h,v,c,l,o,y,r,p,f,e,s;if(s=$(this).parents("tr"),typeof r!="undefined"&&r!==null&&(i=r),r=Number(s.find("td:eq(1)").text()),f=s.find("td:eq(3)"),e=f.text(),p=new RegExp("("+n+")","i"),o=Boolean(e.match(p)),l=r>=i,l&&(t.length=r+1),y=l?o:o||t[r+1],o?(c=p.exec(e).index,h=e.substr(0,c)+"<em>"+e.substr(c,n.length)+"<\/em>"+e.substr(c+n.length)):h=e,$("span+span",f).length?$("span+span",f).html(h):(v=$("span",f).html(),$(">span",f).html(v.substr(0,v.lastIndexOf(">")+1)),$(">span",f).append($("<span>").html(h))),o&&!l)for(u=s.next(),a=Number(u.find("td:eq(1)").text());u.length&&a>r;)u.show(),u=u.next(),a=Number(u.find("td:eq(1)").text());return t[r]=y||t[r],i=r,s.toggle(y)})},t}()})}).call(this);