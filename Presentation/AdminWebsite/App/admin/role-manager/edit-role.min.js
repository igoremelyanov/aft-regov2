(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}},i={}.hasOwnProperty,r=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n},t=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};define(function(i){var e,o,u,s,f,a,h,c,l,v;return h=i("nav"),a=i("komapping"),f=i("i18next"),v=i("toastr"),o=i("base/base-view-model"),l=i("admin/role-manager/model/role-model"),s=i("admin/role-manager/helpers/grid-helper"),u=i("config"),i("controls/grid"),c=function(){return $("#role-grid").trigger("reload")},e=function(e){function o(){this.onsave=n(this.onsave,this);this.compositionComplete=n(this.compositionComplete,this);o.__super__.constructor.apply(this,arguments);this.SavePath=u.adminApi("RoleManager/UpdateRole");this.contentType("application/json");jQuery.ajaxSettings.traditional=!0;this.gridHelper=new s}return r(o,e),o.prototype.setup=function(n){return console.log("data"),console.log(n),this.Model.mapfrom(n.role),this.Model.licensees(n.licensees),this.Model.displayLicensees(this.Model.licensees().filter(function(n){return function(i){var r;return r=i.id,t.call(n.Model.assignedLicensees(),r)>=0}}(this)).map(function(){return function(n){return n.name}}(this)).join(", "))},o.prototype.compositionComplete=function(){return this.gridHelper.init($("#security-grid")),$(function(n){return function(){return n.collapseGrid(),$("#permission-search-button").click(function(){return n.gridHelper.filter($("#permission-search").val()),!1})}}(this))},o.prototype.expandGrid=function(){return $(".treeclick.ui-icon-triangle-1-e").click()},o.prototype.collapseGrid=function(){return $(".treeclick.ui-icon-triangle-1-s:not(:first)").click()},o.prototype.isPermissionChecked=function(n){return this.Model.checkedPermissions().indexOf(n)},o.prototype.beforesave=function(){return this.Model.checkedPermissions(this.gridHelper.getChecked()),!0},o.prototype.onsave=function(){var n;return c(),this.success(f.t("app:admin.messages.roleSuccessfullyUpdated")),h.title(f.t("app:admin.roleManager.viewRole")),this.Model.displayLicensees(this.Model.licensees().filter(function(n){return function(i){var r;return r=i.id,t.call(n.Model.assignedLicensees(),r)>=0}}(this)).map(function(){return function(n){return n.name}}(this)).join(", ")),n=i("security/security"),n.reload(),this.readOnly(!0)},o.prototype.activate=function(n){var t;return o.__super__.activate.apply(this,arguments),this.Model=new l,t=n.id,$.get(u.adminApi("RoleManager/GetEditData"),{id:t}).done(function(n){return function(t){return n.setup(t)}}(this))},o.prototype.clear=function(){return o.__super__.clear.apply(this,arguments),this.gridHelper.reset()},o}(o),new e})}).call(this);