(function(){var t=function(n,t){return function(){return n.apply(t,arguments)}},i={}.hasOwnProperty,r=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n},n=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};define(function(i){var o,s,f,h,e,a,c,v,l,u,y;return c=i("nav"),a=i("komapping"),e=i("i18next"),y=i("toastr"),s=i("base/base-view-model"),l=i("admin/role-manager/model/role-model"),h=i("admin/role-manager/helpers/grid-helper"),u=i("security/security"),f=i("config"),i("controls/grid"),v=function(){return $("#role-list").trigger("reload")},o=function(o){function s(){this.onsave=t(this.onsave,this);this.compositionComplete=t(this.compositionComplete,this);s.__super__.constructor.apply(this,arguments);this.SavePath=f.adminApi("RoleManager/CreateRole");this.contentType("application/json");jQuery.ajaxSettings.traditional=!0;this.gridHelper=new h}return r(s,o),s.prototype.clear=function(){return s.__super__.clear.apply(this,arguments),this.gridHelper.reset()},s.prototype.activate=function(){return s.__super__.activate.apply(this,arguments),console.log("activate"),this.Model=new l,this.Model.checkedPermissions.subscribe(function(n){return function(){return n.gridHelper.reload()}}(this)),$.get(f.adminApi("RoleManager/GetEditData")).done(function(t){return function(i){return t.Model.licensees(i.licensees),t.Model.isLicenseeLocked()?(t.Model.assignedLicensees(u.licensees()),t.Model.displayLicensees(i.licensees.filter(function(i){var r;return r=i.id,n.call(t.Model.assignedLicensees(),r)>=0}).map(function(n){return n.name}).join(", "))):t.Model.displayLicensees(t.Model.licensees().filter(function(i){var r;return r=i.id,n.call(t.Model.assignedLicensees(),r)>=0}).map(function(n){return n.name}).join(", "))}}(this))},s.prototype.compositionComplete=function(){return this.gridHelper.init($("#security-grid")),$(function(n){return function(){return n.collapseGrid(),$("#permission-search-button").click(function(){return n.gridHelper.filter($("#permission-search").val()),!1})}}(this))},s.prototype.expandGrid=function(){return $(".treeclick.ui-icon-triangle-1-e").click()},s.prototype.collapseGrid=function(){return $(".treeclick.ui-icon-triangle-1-s:not(:first)").click()},s.prototype.beforesave=function(){return this.Model.checkedPermissions(this.gridHelper.getChecked()),!0},s.prototype.onsave=function(){return this.success(e.t("app:admin.messages.roleSuccessfullyCreated")),this.Model.displayLicensees(this.Model.licensees().filter(function(t){return function(i){var r;return r=i.id,n.call(t.Model.assignedLicensees(),r)>=0}}(this)).map(function(){return function(n){return n.name}}(this)).join(", ")),c.title(e.t("app:admin.roleManager.viewRole")),$("#role-grid").trigger("reload"),u=i("security/security"),u.reload(),this.readOnly(!0)},s}(s),new o})}).call(this);