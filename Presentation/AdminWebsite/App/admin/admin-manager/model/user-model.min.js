(function(){var t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n},n=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};define(function(t){var e,u,f,r,o;return o=t("komapping"),r=t("i18next"),e=t("controls/assign"),u=t("base/base-model"),f=t("config"),function(u){function e(){var i;e.__super__.constructor.apply(this,arguments);this.username=this.makeField().extend({required:!0,minLength:6,maxLength:50}).extend({pattern:{message:r.t("admin.messages.usernameInvalid"),params:"^[A-Za-z0-9]+(?:[._'-][A-Za-z0-9]+)*$"}});this.password=this.makeField().extend({required:!0,minLength:6,maxLength:50,validation:{validator:function(){return function(n){return!/\s/.test(n)}}(this),message:r.t("admin.messages.passwordWhitespaces"),params:!0}});this.passwordConfirmation=this.makeField().extend({validation:{validator:function(n){return function(t){return t===n.password()}}(this),message:r.t("admin.messages.passwordMatch"),params:!0}});this.firstName=this.makeField().extend({required:!0,minLength:1,maxLength:50}).extend({pattern:{message:r.t("admin.messages.firstNameInvalid"),params:"^[A-Za-z0-9]+(?:[ .'-][A-Za-z0-9]+)*$"}});this.lastName=this.makeField().extend({required:!0,minLength:1,maxLength:50}).extend({pattern:{message:r.t("admin.messages.lastNameInvalid"),params:"^[A-Za-z0-9]+(?:[ .'-][A-Za-z0-9]+)*$"}});this.description=this.makeField();this.isActive=this.makeField(!1);this.isActive.ForEditing=ko.computed({read:function(n){return function(){return n.isActive().toString()}}(this),write:function(n){return function(t){return n.isActive(t==="true")}}(this),owner:this});this.isActive.ToStatus=ko.computed({read:function(n){return function(){return n.isActive()?"Active":"Inactive"}}(this)});this.languages=ko.observableArray([{name:"English"}]);this.language=this.makeField("English");this.remarks=ko.observable();this.roles=ko.observableArray();this.roleId=this.makeField().extend({required:!0});this.role=this.makeField();this.roleUid=ko.observable();this.displayRole=ko.computed(function(n){return function(){var t;if(n.roles()!=null)return function(){var n,u,i,r;for(i=this.roles(),r=[],n=0,u=i.length;n<u;n++)t=i[n],t.id===this.roleId()&&r.push(t.name);return r}.call(n)[0]}}(this));this.licensees=ko.observableArray();this.assignedLicensees=this.makeArrayField().extend({validation:{validator:function(){return function(n){return(n!=null?n.length:void 0)>0}}(this),message:r.t("admin.messages.licenseesRequired"),params:!0}});this.assignedLicensees.onclear=function(n){return function(){if(!n.isLicenseeLocked())return n.assignedLicensees([])}}(this);this.displayLicensees=ko.computed(function(t){return function(){if(t.licensees()!=null)return t.licensees().filter(function(i){var r;return r=i.id,n.call(t.assignedLicensees(),r)>=0}).map(function(n){return n.name}).join(", ")}}(this));this.clearLock=ko.observable(!0);i=t("security/security");this.isLicenseeLocked=ko.computed(function(){return function(){return i.licensees()!=null&&i.licensees().length>0&&!i.isSuperAdmin()}}(this));this.assignedLicensees.subscribe(function(t){return function(i){var r;if(i!=null)return r={Licensees:i,UseBrandFilter:t.id==null},$.ajax({type:"POST",url:f.adminApi("AdminManager/GetLicenseeData"),data:ko.toJSON(r),dataType:"json",contentType:"application/json"}).done(function(i){var r,u;return t.roles(i.roles),i.roles.length>0&&t.roleId.setValueAndDefault(i.roles[0].id),t.availableBrands(i.brands),t.availableCurrencies(i.currencies),t.roleUid()!=null&&t.roleId(t.roleUid()),t.allowedBrands(function(){var t,f,i,u;for(i=this.allowedBrands(),u=[],t=0,f=i.length;t<f;t++)r=i[t],n.call(this.availableBrands().map(function(n){return n.id}),r)>=0&&u.push(r);return u}.call(t)),t.currencies(function(){var t,f,i,r;for(i=this.currencies(),r=[],t=0,f=i.length;t<f;t++)u=i[t],n.call(this.availableCurrencies().map(function(n){return n.code}),u)>=0&&r.push(u);return r}.call(t))})}}(this));this.currencies=this.makeArrayField().extend({validation:{validator:function(n){return function(t){return(t!=null?t.length:void 0)>0||n.isLicenseeLocked()}}(this),message:r.t("admin.messages.currenciesRequired"),params:!0}});this.allowedBrands=this.makeArrayField().extend({validation:{validator:function(){return function(n){return(n!=null?n.length:void 0)>0}}(this),message:r.t("admin.messages.brandsRequired"),params:!0}});this.availableBrands=ko.observableArray();this.displayBrands=ko.computed(function(t){return function(){var i;return function(){var t,f,r,e,u;for(r=this.availableBrands(),u=[],t=0,f=r.length;t<f;t++)i=r[t],(e=i.id,n.call(this.allowedBrands(),e)>=0)&&u.push(i.name);return u}.call(t).join(", ")}}(this));this.displayCurrencies=ko.computed(function(n){return function(){return n.currencies().join(", ")}}(this));this.availableCurrencies=ko.observableArray();this.isSingleBrand=ko.computed(function(){return function(){return i.isSingleBrand()}}(this));this.singleBrand=ko.computed({read:function(n){return function(){var t;if(((t=n.allowedBrands())!=null?t.length:void 0)>0)return n.allowedBrands()[0]}}(this),write:function(n){return function(t){if(n.isSingleBrand())return n.allowedBrands([t])}}(this),owner:this})}return i(e,u),e.prototype.mapto=function(){var n;return n=e.__super__.mapto.apply(this,arguments),n.status=this.isActive.ToStatus(),n},e.prototype.mapfrom=function(n){return e.__super__.mapfrom.call(this,n),this.isActive(n.status==="Active"),this.role(n.roleName),this.roleUid(n.roleId)},e}(u)})}).call(this);