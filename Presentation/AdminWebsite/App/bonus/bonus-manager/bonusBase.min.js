(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["nav","bonus/bonusCommon","i18next","security/security","config"],function(t,i,r,u,f){return function(){function e(){this.openViewTemplateTab=n(this.openViewTemplateTab,this);var e,t,o;this.Id=ko.observable();this.Name=ko.observable().extend({required:i.requireValidator,pattern:i.nameValidator});this.Code=ko.observable();this.TemplateId=ko.observable().extend({required:i.requireValidator});this.Description=ko.observable().extend({required:i.requireValidator});this.ActiveFrom=ko.observable();this.ActiveTo=ko.observable().extend({notEqual:{params:"0001/01/01",message:r.t("common.requiredField")}});this.DaysToClaim=ko.observable().extend({required:i.requireValidator});this.DurationType=ko.observable();this.DurationDays=ko.observable();this.DurationHours=ko.observable();this.DurationMinutes=ko.observable();this.DurationStart=ko.observable();this.DurationStart.subscribe(function(n){return function(){return n.DurationType.valueHasMutated()}}(this));this.DurationEnd=ko.observable();this.DurationEnd.subscribe(function(n){return function(){return n.DurationType.valueHasMutated()}}(this));this.serverErrors=ko.observable();this.templates=ko.observableArray();this.availableDays=function(){var n,i;for(i=[],t=n=1;n<=365;t=++n)i.push(t);return i}();this.availableHours=function(){var n,i;for(i=[],t=n=1;n<=24;t=++n)i.push(t);return i}();this.availableMinutes=function(){var n,i;for(i=[],t=n=1;n<=60;t=++n)i.push(t);return i}();e=r.t("bonus.bonusDurations",{returnObjectTrees:!0});this.availableDurations=function(){var n=[];for(o in e)n.push({id:o,name:e[o]});return n}();this.DurationType(this.availableDurations[0].id);this.errors=ko.validation.group(this);this.isAddBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions.create,u.categories.bonusTemplateManager)});this.isViewBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions.view,u.categories.bonusTemplateManager)});this.formatTimeString=function(n,t,i){return""+n+" "+this.daysCaption()+", "+t+" "+this.hoursCaption()+", "+i+" "+this.minutesCaption()};this.reloadTemplates=function(n){return function(){return $.get(f.adminApi("BonusTemplate/GetRelatedData")).done(function(t){return n.templates(t.templates)})}}(this);this.emptyCaption=i.emptyCaption;this.daysCaption=ko.observable(r.t("bonus.bonusFields.days"));this.hoursCaption=ko.observable(r.t("bonus.bonusFields.hours"));this.minutesCaption=ko.observable(r.t("bonus.bonusFields.minutes"));this.vDurationDays=ko.computed({read:function(n){return function(){return n.DurationDays()===0?"":n.DurationDays()}}(this),write:function(n){return function(t){return t===void 0&&(t=0),n.DurationDays(t),n.DurationType.valueHasMutated()}}(this)});this.vDurationHours=ko.computed({read:function(n){return function(){return n.DurationHours()===0?"":n.DurationHours()}}(this),write:function(n){return function(t){return t===void 0&&(t=0),n.DurationHours(t),n.DurationType.valueHasMutated()}}(this)});this.vDurationMinutes=ko.computed({read:function(n){return function(){return n.DurationMinutes()===0?"":n.DurationMinutes()}}(this),write:function(n){return function(t){return t===void 0&&(t=0),n.DurationMinutes(t),n.DurationType.valueHasMutated()}}(this)})}return e.prototype.cancel=function(){return t.close()},e.prototype.openAddTemplateTab=function(){return t.open({path:"bonus/template-manager/wizard",title:r.t("bonus.templateManager.new")})},e.prototype.openViewTemplateTab=function(){return t.open({path:"bonus/template-manager/wizard",title:r.t("bonus.templateManager.view"),data:{id:this.TemplateId(),view:!0}})},e}()})}).call(this);