(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}},t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};define(["./bonusBase","komapping","moment","i18next","config"],function(t,r,u,f,e){return function(t){function f(){this.activate=n(this.activate,this);f.__super__.constructor.call(this);this.LicenseeName=ko.observable("");this.BrandName=ko.observable("");this.created=ko.observable(!1);this.edited=ko.observable(!1);this.formatDateRange=function(n,t,i){var f,r,e;return r="YYYY/MM/DD",i&&(r+=" HH:mm"),e=u(n,r).format(r),f=u(t,r).format(r),"from "+e+" to "+f};this.vTemplateName=ko.computed(function(n){return function(){var i,t,u,r;for(r=n.templates(),t=0,u=r.length;t<u;t++)if(i=r[t],i.Id===n.TemplateId())return i.Name;return n.emptyCaption()}}(this));this.vCode=ko.computed(function(n){return function(){return n.Code()!=null?n.Code():n.emptyCaption()}}(this));this.vDuration=ko.computed(function(n){return function(){var t,i;return n.DurationType()===1?(t=n.formatTimeString(n.DurationDays(),n.DurationHours(),n.DurationMinutes()),i=n.formatDateRange(n.ActiveFrom(),n.DurationEnd(),!0),""+t+" ("+i+")"):n.formatDateRange(n.DurationStart(),n.DurationEnd(),!0)}}(this));this.vActivityRange=ko.computed(function(n){return function(){return n.formatDateRange(n.ActiveFrom(),n.ActiveTo(),!1)}}(this))}return i(f,t),f.prototype.activate=function(n){return n.created!==void 0&&this.created(!0),n.edited!==void 0&&this.edited(!0),$.get(e.adminApi("Bonus/GetRelatedData"),{id:n.id}).done(function(n){return function(t){return r.fromJS(t.Bonus,{},n),n.templates(t.Templates),n.TemplateId.valueHasMutated()}}(this))},f}(t)})}).call(this);