(function(){define(["i18next","./changeTracker","./rewardTier","bonus/bonusCommon"],function(n,t,i,r){return function(){function u(u,f){this.isFirstOrReloadDeposit=ko.computed(function(){return u()===r.allTypes[0].id||u()===r.allTypes[1].id});this.isHighDeposit=ko.computed(function(){return u()===r.allTypes[2].id});this.isReferFriends=ko.computed(function(){return u()===r.allTypes[3].id});this.isVerification=ko.computed(function(){return u()===r.allTypes[4].id});this.isFundIn=ko.computed(function(){return u()===r.allTypes[5].id});this.availableCurrencies=ko.computed(function(){var n;if((n=f())!=null)return n.Currencies});this.currencies=ko.observable([]).extend({arrayNotEmpty:{message:n.t("bonus.messages.noCurrency")}});this.RewardType=ko.observable(0);this.isAmountRewardType=ko.computed(function(n){return function(){return n.RewardType()===0}}(this));this.isPercentageRewardType=ko.computed(function(n){return function(){return n.RewardType()===1}}(this));this.enableFlatReward=ko.computed(function(n){return function(){return n.isAmountRewardType()||n.isPercentageRewardType()}}(this));this.isAmountTieredReward=ko.computed(function(n){return function(){return n.RewardType()===2}}(this));this.isPercentageTieredReward=ko.computed(function(n){return function(){return n.RewardType()===3}}(this));this.isTieredReward=ko.computed(function(n){return function(){return n.isAmountTieredReward()||n.isPercentageTieredReward()}}(this));this.RewardTiers=ko.observableArray();this.currencies.subscribe(function(n){return function(t){var s,u,o,h,r,f,c,e;for(s=function(){var n,u,t,i;for(t=this.RewardTiers(),i=[],n=0,u=t.length;n<u;n++)r=t[n],i.push(r.CurrencyCode);return i}.call(n),o=ko.utils.compareArrays(s,t),e=[],f=0,c=o.length;f<c;f++)u=o[f],u.status==="added"&&(r=new i,r.CurrencyCode=u.value,r.addBonusTier(),n.RewardTiers.push(r)),u.status==="deleted"?(h=ko.utils.arrayFirst(n.RewardTiers(),function(n){return n.CurrencyCode===u.value}),e.push(n.RewardTiers.remove(h))):e.push(void 0);return e}}(this));this.FundInWallets=ko.observableArray();this.IsAutoGenerateHighDeposit=ko.observable();this.IsAutoGenerateHighDeposit.subscribe(function(n){return function(t){var f,i,e,r,u;if(t===!0){for(r=n.RewardTiers(),u=[],i=0,e=r.length;i<e;i++)f=r[i],u.push(f.BonusTiers.splice(1));return u}}}(this));this.basedOnAmountText=ko.computed(function(t){return function(){return t.isReferFriends()?"":t.isFundIn()?n.t("bonus.templateFields.fundInAmount"):t.isHighDeposit()?"":n.t("bonus.templateFields.depositAmount")}}(this));this.fromLabelText=ko.computed(function(t){return function(){return t.isReferFriends()?n.t("bonus.bonusFields.refferalFrom"):t.isFundIn()?n.t("bonus.bonusFields.fundInFrom"):t.isHighDeposit()?n.t("bonus.templateFields.monthlyAccumulatedDepositAmount"):n.t("bonus.bonusFields.depositFrom")}}(this));this.rewardLabelText=ko.computed(function(t){return function(){return t.isReferFriends()?n.t("bonus.bonusFields.bonusAmountPerPlayer"):t.isPercentageTieredReward()||t.isPercentageRewardType()?n.t("bonus.bonusFields.percentageReward"):n.t("bonus.bonusFields.rewardValue")}}(this));this.showMaxAmount=ko.computed(function(n){return function(){return(n.isPercentageTieredReward()||n.isPercentageRewardType())&&n.isReferFriends()===!1}}(this));this.showTierButtons=ko.computed(function(n){return function(){return(n.isAmountTieredReward()||n.isPercentageTieredReward())&&!n.IsAutoGenerateHighDeposit()}}(this));this.referFriendValidator={required:{message:n.t("common.requiredField"),onlyIf:this.isReferFriends},number:{params:!0,message:n.t("bonus.messages.positiveNumber"),onlyIf:this.isReferFriends}};this.ReferFriendMinDepositAmount=ko.observable().extend(this.referFriendValidator);this.ReferFriendWageringCondition=ko.observable().extend(this.referFriendValidator);this.rewardTypeString=ko.observable();this.selectRewardType=function(t){return function(i){return t.rewardTypeString(n.t("bonus.rewardTypes."+i)),t.RewardType(i)}}(this);this.rewardTypeSelectionIsActive=ko.computed(function(n){return function(){return n.isHighDeposit()||n.isReferFriends()?(n.selectRewardType(2),!1):n.isVerification()?(n.selectRewardType(0),!1):(n.isFundIn()&&n.selectRewardType(0),!0)}}(this));this.availableRewardTypes=ko.computed(function(){for(var i,r=[],t=i=0;i<=3;t=++i)r.push({id:t,name:n.t("bonus.rewardTypes."+t)});return r});this.availableWallets=ko.computed(function(){var n;return ko.utils.arrayFilter((n=f())!=null?n.WalletTemplates:void 0,function(n){return n.IsMain===!1})});this.RewardType.subscribe(function(n){return function(){var u,t,f,i,r;if(n.enableFlatReward()){for(i=n.RewardTiers(),r=[],t=0,f=i.length;t<f;t++)u=i[t],r.push(u.BonusTiers.splice(1));return r}}}(this));new t(this);ko.validation.group(this)}return u}()})}).call(this);