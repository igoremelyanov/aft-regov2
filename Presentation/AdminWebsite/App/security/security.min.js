(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(function(t){var r,u,i,f;return f=t("toastr"),i=t("i18next"),u=t("durandal/app"),r=function(){function t(){this.compositionComplete=n(this.compositionComplete,this);this.activate=n(this.activate,this);this.reload=n(this.reload,this);this.userName=ko.observable();this.operations=ko.observableArray();this.useroperations=ko.observableArray();this.licensees=ko.observableArray();this.isSingleBrand=ko.observable();this.isSuperAdmin=ko.observable();this.permissions={};this.categories={}}return t.prototype.reload=function(){return $.post("/home/getsecuritydata",{}).then(function(n){return function(t){return console.log(t),t?(n.userName(t.userName),n.operations(t.operations),n.useroperations(t.userPermissions),n.licensees(t.licensees),n.permissions=t.permissions,n.categories=t.categories,n.isSingleBrand(t.isSingleBrand),n.isSuperAdmin(t.isSuperAdmin)):void 0}}(this))},t.prototype.activate=function(){return this.reload()},t.prototype.compositionComplete=function(){return $(document).ajaxError(function(n,t,r,e){var o;console.log("error");console.log(t);console.log(e);switch(t.status){case 500:if(o=t.responseJSON,o!=null&&o.error_message!=null)return f.error(o.error_message+" "+o.Message);break;case 408:case 403:return location.reload();case 504:return u.showMessage(i.t("app:common.sessionExpired"),i.t("app:common.sessionExpiredTitle"),[{text:"OK",value:!0}],!1,{style:{width:"350px"},"class":"messageBox center"}).then(function(){return function(){return $("#initial-loader").show(),location.href="Account/Logout"}}(this)),$(".modal-footer").toggleClass("center")}})},t.prototype.isOperationAllowed=function(n,t){var r,i,u;return console.log("isOperationAllowed"),console.log(n),console.log(t),console.log(function(){var n,u,t,r;for(t=this.operations(),r=[],n=0,u=t.length;n<u;n++)i=t[n],this.useroperations.indexOf(i.id)>-1&&r.push(i);return r}.call(this)),u=ko.utils.arrayFilter(this.operations,function(n){return function(t){return ko.utils.arrayFirst(n.useroperations,function(n){return n===t.id})!=null}}(this)),r=function(){var r,e,u,f;for(u=this.operations(),f=[],r=0,e=u.length;r<e;r++)i=u[r],this.useroperations.indexOf(i.id)>-1&&i.name===n&&i.module===t&&f.push(i);return f}.call(this),console.log(r),(r!=null?r.length:void 0)>0},t}(),new r})}).call(this);