(function(){var n={}.hasOwnProperty,t=function(t,i){function u(){this.constructor=t}for(var r in i)n.call(i,r)&&(t[r]=i[r]);return u.prototype=i.prototype,t.prototype=new u,t.__super__=i.prototype,t};define(function(n){var u,f,i,r,e;return r=n("nav"),i=n("i18next"),e=n("dateTimePicker"),f=n("base/base-view-model"),u=n("payments/bank-accounts/models/add-bank-account-model"),function(n){function f(){f.__super__.constructor.apply(this,arguments);this.SavePath="/BankAccounts/Add";this.message=ko.observable();this.messageClass=ko.observable();this.Model=new u}return t(f,n),f.prototype.compositionComplete=function(){return $("input#"+this.Model.uploadId1FieldId()).ace_file_input(this.Model.makeFileInputSettings(this.Model.idFrontImage())),$("input#"+this.Model.uploadId2FieldId()).ace_file_input(this.Model.makeFileInputSettings(this.Model.idBackImage())),$("input#"+this.Model.uploadId3FieldId()).ace_file_input(this.Model.makeFileInputSettings(this.Model.atmCardImage()))},f.prototype.handleSaveFailure=function(n){var e,u,t,r,o,f;if(alert("failure"),t=n!=null?n.fields:void 0,t!=null){for(f=[],r=0,o=t.length;r<o;r++)u=t[r],e=u.errors[0],f.push(this.showError(this.Model[u.name],i.t("app:banks.validation."+e)));return f}},f.prototype.save=function(){var t,n;return this.clearMessage(),this.Model.validate()?(t={bank:this.Model.bankId(),brandId:this.Model.brandId(),licenseeId:this.Model.licenseeId(),currency:this.Model.currencyCode(),accountId:this.Model.bankAccountId(),accountName:this.Model.bankAccountName(),accountNumber:this.Model.bankAccountNumber(),accountType:this.Model.bankAccountAccountTypeId(),province:this.Model.bankAccountProvince(),branch:this.Model.bankAccountBranch(),remarks:this.Model.remarks(),supplierName:this.Model.supplierName(),contactNumber:this.Model.contactNumber(),uSBCode:this.Model.usbCode(),purchasedDate:this.Model.purchasedDate(),utilizationDate:this.Model.utilizationDate(),expirationDate:this.Model.expirationDate()},n=new FormData,n.append("uploadId1",$("input#"+this.Model.uploadId1FieldId())[0].files[0]),n.append("uploadId2",$("input#"+this.Model.uploadId2FieldId())[0].files[0]),n.append("uploadId3",$("input#"+this.Model.uploadId3FieldId())[0].files[0]),n.append("bankAccount",JSON.stringify(t)),$.ajax({type:"POST",url:this.SavePath,data:n,processData:!1,contentType:!1,xhr:function(n){return function(){var t;return t=new XMLHttpRequest,t.onreadystatechange=function(){var u;if(4===t.readyState)return u=JSON.parse(t.responseText),u.result==="failed"?n.showError(u.data):(r.close(),r.open({path:"payments/bank-accounts/view",title:i.t("app:banks.viewAccount"),key:u.data.id,data:{id:u.data.id,message:i.t("app:bankAccounts.created")}}),$("#bank-accounts-list").trigger("reloadGrid"))},t}}(this)})):this.showError("notValid")},f.prototype.showError=function(n){return this.message(i.t("app:bankAccounts."+n)),this.messageClass("alert alert-danger")},f.prototype.showMessage=function(n){return this.message(n),this.messageClass("alert alert-success")},f.prototype.clearMessage=function(){return this.message(""),this.messageClass("")},f.prototype.cancel=function(){return r.close()},f}(f)})}).call(this);