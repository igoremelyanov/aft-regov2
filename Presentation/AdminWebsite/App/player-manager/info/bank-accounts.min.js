(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["i18next","security/security","nav","payments/player-bank-accounts/result-dialog","config"],function(t,i,r,u,f){return function(){function e(){this.setCurrentBankAccount=n(this.setCurrentBankAccount,this);this.playerId=ko.observable();this.bankAccountsSelectedRowId=ko.observable();this.bankAccountData=ko.observable();this.hasEditBankAccountsPermission=ko.computed(function(){return i.isOperationAllowed(i.permissions.update,i.categories.playerBankAccount)});this.hasAddBankAccountsPermission=ko.computed(function(){return i.isOperationAllowed(i.permissions.create,i.categories.playerBankAccount)});this.canSetCurrentBankAccount=ko.computed(function(n){return function(){var t;return(t=n.bankAccountsSelectedRowId(),!t)?!1:n.bankAccountData()?n.bankAccountData().IsCurrent!=="Yes":!1}}(this));this.gridId=null}return e.prototype.activate=function(n){return this.playerId(n.playerId)},e.prototype.attached=function(n){var r,t,i;t=this;r=findGrid(n);i=r.find(".ui-jqgrid-btable");t.gridId=i.attr("id");return $(n).on("click",".jqgrow",function(){return t.bankAccountsSelectedRowId($(this).attr("id")),t.bankAccountData(i.jqGrid("getRowData",t.bankAccountsSelectedRowId()))})},e.prototype.openAddBankAccountForm=function(n){return r.open({path:"payments/player-bank-accounts/edit",title:t.t("app:banks.newAccount"),data:{playerInfo:this,playerId:n.playerId(),naming:{gridBodyId:this.gridId}}})},e.prototype.openEditBankAccountForm=function(){return r.open({path:"payments/player-bank-accounts/edit",title:t.t("app:banks.editAccount"),data:{playerInfo:this,id:this.bankAccountsSelectedRowId(),naming:{gridBodyId:this.gridId}}})},e.prototype.openViewBankAccountForm=function(){return r.open({path:"payments/player-bank-accounts/edit",title:t.t("app:banks.viewAccount"),data:{playerInfo:this,id:this.bankAccountsSelectedRowId(),isView:!0,naming:{gridBodyId:this.gridId}}})},e.prototype.setCurrentBankAccount=function(){return $.ajax({type:"POST",url:f.adminApi("PlayerManager/SetCurrentBankAccount"),data:ko.toJSON({playerBankAccountId:this.bankAccountsSelectedRowId()}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){return function(i){var o,r,f,e;return r=void 0,f=void 0,e=void 0,i.result==="success"?(r=!0,f=t.t("app:payment.successfulySetCurrentBankAccount"),e="alert-success"):(r=!1,o=JSON.parse(i.fields[0].errors[0]),f=t.t(o.text),e="alert-danger"),u.show(t.t("app:payment.settingCurrentBankAccount"),f,e),r?($("#"+n.gridId).trigger("reloadGrid"),n.bankAccountsSelectedRowId(null)):void 0}}(this))},e}()})}).call(this);