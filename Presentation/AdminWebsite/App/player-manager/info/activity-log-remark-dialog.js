// Generated by IcedCoffeeScript 108.0.9
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(function(require) {
    var UserStatusDialog, config, dialog, i18N;
    dialog = require("plugins/dialog");
    i18N = require("i18next");
    config = require("config");
    return UserStatusDialog = (function() {
      function UserStatusDialog(logId, remarks) {
        this.ok = __bind(this.ok, this);
        this.title = ko.observable();
        this.remarks = ko.observable(remarks).extend({
          required: true
        });
        this.logId = ko.observable(logId);
        this.errors = ko.validation.group(this);
        this.submitted = ko.observable(false);
        this.message = ko.observable();
        this.error = ko.observable();
      }

      UserStatusDialog.prototype.ok = function() {
        if (this.isValid()) {
          return $.ajax({
            type: "POST",
            url: config.adminApi("PlayerInfo/EditLogRemark"),
            data: ko.toJSON({
              logId: this.logId(),
              remarks: this.remarks()
            }),
            contentType: "application/json".done((function(_this) {
              return function(data) {};
            })(this))
          }, data.result === "failed" ? this.error(data.data) : (this.message("Remark edited"), this.submitted(true), typeof this.callback === "function" ? this.callback() : void 0));
        } else {
          return this.errors.showAllMessages();
        }
      };

      UserStatusDialog.prototype.cancel = function() {
        return dialog.close(this);
      };

      UserStatusDialog.prototype.clear = function() {
        return this.remarks("");
      };

      UserStatusDialog.prototype.show = function(callback) {
        this.title("Edit remarks");
        this.callback = callback;
        return dialog.show(this);
      };

      return UserStatusDialog;

    })();
  });

}).call(this);
