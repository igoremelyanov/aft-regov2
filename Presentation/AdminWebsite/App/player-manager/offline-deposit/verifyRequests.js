// Generated by IcedCoffeeScript 108.0.9
(function() {
  define(function(require) {
    var ViewModel, i18n, nav, security;
    require("controls/grid");
    nav = require("nav");
    i18n = require("i18next");
    security = require("security/security");
    return ViewModel = (function() {
      function ViewModel() {
        this.selectedRowId = ko.observable();
        this.selectedRowDepositType = ko.observable();
        this.usernameSearchPattern = ko.observable();
        this.filterVisible = ko.observable(false);
        this.paymentMethods = ko.observableArrays()[0];
        this.isVerifyBtnVisible = ko.computed(function() {
          return security.isOperationAllowed(security.permissions.verify, security.categories.depositVerification);
        });
        this.isUnverifyBtnVisible = ko.computed(function() {
          return security.isOperationAllowed(security.permissions.unverify, security.categories.depositVerification);
        });
        this.isRejectBtnVisible = ko.computed(function() {
          return security.isOperationAllowed(security.permissions.reject, security.categories.depositVerification);
        });
        this.compositionComplete = (function(_this) {
          return function() {
            return $(function() {
              $("#deposit-verify-grid").on("gridLoad selectionChange", function(e, row) {
                _this.selectedRowId(row.id);
                return _this.selectedRowDepositType(row.data.DepositType);
              });
              return $("#deposit-verify-username-search-form").submit(function() {
                _this.usernameSearchPattern($('#deposit-verify-username-search').val());
                $("#deposit-verify-grid").trigger("reload");
                return false;
              });
            });
          };
        })(this);
      }

      ViewModel.prototype.verifyDepositRequest = function() {
        return nav.open({
          path: this.getPath(),
          title: i18n.t("app:common.verify"),
          data: {
            hash: '#offline-deposit-confirm',
            requestId: this.selectedRowId(),
            action: 'verify'
          }
        });
      };

      ViewModel.prototype.unverifyDepositRequest = function() {
        return nav.open({
          path: this.getPath(),
          title: i18n.t("app:common.unverify"),
          data: {
            hash: '#offline-deposit-confirm',
            requestId: this.selectedRowId(),
            action: 'unverify'
          }
        });
      };

      ViewModel.prototype.rejectDepositRequest = function() {
        return nav.open({
          path: this.getPath(),
          title: i18n.t("app:common.reject"),
          data: {
            hash: '#online-deposit-reject',
            requestId: this.selectedRowId(),
            action: 'reject'
          }
        });
      };

      ViewModel.prototype.getPath = function() {
        var url;
        if (this.selectedRowDepositType() === 'Online') {
          return url = 'player-manager/offline-deposit/verifyOnlineDeposit';
        } else {
          return url = 'player-manager/offline-deposit/verify';
        }
      };

      ViewModel.prototype.activate = function() {
        return $.get("/PaymentSettings/PaymenMethodsList").done((function(_this) {
          return function(response) {
            var item, _i, _len, _results;
            _results = [];
            for (_i = 0, _len = response.length; _i < _len; _i++) {
              item = response[_i];
              _results.push(_this.paymentMethods.push(item));
            }
            return _results;
          };
        })(this));
      };

      return ViewModel;

    })();
  });

}).call(this);
