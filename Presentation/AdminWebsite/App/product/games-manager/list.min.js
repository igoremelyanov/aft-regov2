(function(){define(["nav","durandal/app","i18next","security/security","shell","controls/grid","config"],function(n,t,i,r,u,f,e){return function(){function f(){this.shell=u;this.gameId=ko.observable();this.canBeEditedDeleted=ko.observable(!1);this.gameManagementEnabled=ko.observable(e.gameManagementEnabled);this.compositionComplete=function(n){return function(){return $("#games-grid").on("gridLoad selectionChange",function(t,i){return n.gameId(i.id)})}}(this);this.isAddBtnVisible=ko.computed(function(){return r.isOperationAllowed(r.permissions.create,r.categories.gameManager)});this.isEditBtnVisible=ko.computed(function(){return r.isOperationAllowed(r.permissions.update,r.categories.gameManager)});this.isDeleteBtnVisible=ko.computed(function(){return r.isOperationAllowed(r.permissions["delete"],r.categories.gameManager)})}return f.prototype.add=function(){return n.open({path:"product/games-manager/edit",title:i.t("app:gameIntegration.games.new")})},f.prototype.edit=function(){if(this.gameId())return n.open({path:"product/games-manager/edit",title:i.t("app:gameIntegration.games.edit"),data:{id:this.gameId()}})},f.prototype.deleteGame=function(){if(this.gameId())return t.showMessage(i.t("gameIntegration.games.confirDelete"),i.t("gameIntegration.games.deleteTitle"),[{text:i.t("common.booleanToYesNo.true"),value:!0},{text:i.t("common.booleanToYesNo.false"),value:!1}],!1,{style:{width:"350px"}}).then(function(n){return function(r){if(r)return $.post("/games/delete",{id:n.gameId()}).done(function(n){return n.success?($("#games-grid").trigger("reload"),t.showMessage(i.t("gameIntegration.games.deleteSuccessful"),i.t("messageTemplates.dialogs.successful"),[i.t("common.close")])):t.showMessage(n.Message,i.t("common.error"),[i.t("common.close")])})}}(this))},f}()})}).call(this);