(function(){define(function(n){var i,r,u,t;return r=n("nav"),i=n("i18next"),t=n("EntityFormUtil"),n("dateTimePicker"),u=0,function(){function n(){var n,r;r=u++;this.loadedGameProvider=null;this.form=new t.Form(this);this.form.makeField("id",ko.observable());this.id=function(){return this.form.fields.id.value()};this.form.makeField("name",ko.observable().extend({required:!0,maxLength:256,minLength:1,maxLength:50,pattern:{message:i.t("app:gameIntegration.gameProviders.nameCharError"),params:"^[A-Za-z0-9-_ ]+$"}}));this.form.makeField("code",ko.observable().extend({required:!0,maxLength:256,minLength:1,maxLength:50,pattern:{message:i.t("app:gameIntegration.gameProviders.codeCharError"),params:"^[A-Za-z0-9-_ ]+$"}}));this.form.makeField("category",ko.observable().extend({required:!0})).withOptions("value","name").holdObject();this.form.makeField("authentication",ko.observable().extend({required:!0})).withOptions("value","name").holdObject();this.form.makeField("securityKey",ko.observable());n=this.form.makeField("securityKeyExpiryDate",ko.observable());n.pickerId=ko.observable("product-security-key-expiry-date-picker-"+r);n.setLoadInput(function(n){if(n.securityKeyExpiryTime)return t.setDateByTimestamp(this.picker,n.securityKeyExpiryTime)});this.form.makeField("authorizationClientId",ko.observable());this.form.makeField("authorizationSecret",ko.observable());t.addCommonMembers(this);this.form.publishIsReadOnly(["category","authentication"]);this.isOauth=ko.computed({read:function(n){return function(){var t;return t=n.form.fields.authentication.value(),t&&t.value===1}}(this)});this.getAuthClientId=function(n){return function(){$.ajax("/GameProviders/GenerateAuthorizationClientId").done(function(t){t.result==="success"&&n.form.fields.authorizationClientId.value(t.data)})}}(this);this.getAuthSecret=function(n){return function(){$.ajax("/GameProviders/GenerateAuthorizationSecret").done(function(t){t.result==="success"&&n.form.fields.authorizationSecret.value(t.data)})}}(this);this.getSecurityKey=function(n){return function(){$.ajax("/GameProviders/GenerateSecurityKey").done(function(t){t.result==="success"&&n.form.fields.securityKey.value(t.data)})}}(this)}var f,e;return n.prototype.activate=function(n){var t;return t=$.Deferred(),$.get("/GameProviders/GetEditData").done(function(i){return function(r){i.form.fields.category.setOptions(r.categories);i.form.fields.authentication.setOptions(r.authenticationItems);n&&n.id?$.get("/GameProviders/GetById",{id:n.id}).done(function(n){var r;i.loadedGameProvider=n;r=i.form.getFieldNameSet();delete r.securityKeyExpiryDate;i.form.loadFields(r,n);t.resolve()}):t.resolve()}}(this)),t.promise()},n.prototype.compositionComplete=function(){var n;n=this.form.fields.securityKeyExpiryDate;t.setupDateTimePicker(n);this.loadedGameProvider&&this.form.fields.securityKeyExpiryDate.loadInput(this.loadedGameProvider)},n.prototype.id=function(){return this.form.fields.id.value()},e={editUrl:"GameProviders/Update"},t.addCommonEditFunctions(n.prototype,e),n.prototype.serializeForm=function(){return JSON.stringify(this.form.getSerializable())},n.prototype.clear=function(){this.form.clear()},f=n.prototype.handleSaveSuccess,n.prototype.handleSaveSuccess=function(n){return f.call(this,n),$("#game-providers-grid").trigger("reload"),r.closeViewTab("id",this.id()),r.title(i.t("app:gameIntegration.gameProviders.view"))},n}()})}).call(this);