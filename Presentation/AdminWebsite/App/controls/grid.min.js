(function(){var n=[].slice;define(function(t){var r,u,f,i;return this.ko.bindingHandlers.grid={init:function(n,t,i,u,f){var e,o;return o=ko.utils.unwrapObservable(t)(),e=[],$("column",n).each(function(){var t,i,n,u,r;for(i={template:this.innerHTML},r=this.attributes,n=0,u=r.length;n<u;n++)t=r[n],i[t.name]=t.value;return e.push(i)}),r.render(n,e,o,u,f)}},window.findGrid=function(n){var t,i;return n=n||window,i="[data-bind^='grid:']",t=$(n).find(i).addBack(i).last(),t.length===0&&(t=$(n).closest(i)),t},u=t("coffee-script"),i=t("shell"),f=t("config"),r=function(){function r(){}return r.render=function(r,u,f,e){for(var b,s,h,l,a,v,it,k,p,c,d,y,w,o,rt,nt,ft,et,ot,tt,g=0,ut=u.length;g<ut;g++)s=u[g],s.name=s.name||s["sort-field"]||s.value||"column_"+Math.random().toString().substr(2);if($(r).append(o=$("<table>",{id:"table_"+Math.random().toString().substr(2)})).prepend(it=$("<div>",{id:o[0].id+"-jqgrid-title-bar","class":"jqgrid-title-bar"})),Array.isArray(ko.unwrap(f.source))&&(h=$(r)[0].gridData=ko.unwrap(f.source),f.source.subscribe!=null&&f.source.subscribe(function(){return $(r)[0].gridData=ko.unwrap(f.source),$(r).trigger("reload")})),$("header",r).children().each(function(){return $(this).appendTo(it)}),$("header, column",r).remove(),f.paging!=null&&(f.paging===!0&&(f.paging={}),$(r).append(y=$("<div>",{id:"pager_"+Math.random().toString().substr(2)}))),c={colNames:function(){var n,i,t;for(t=[],n=0,i=u.length;n<i;n++)s=u[n],t.push(this.columnTitle(s.title||s.value||""));return t}.call(this),colModel:function(){var n,i,t;for(t=[],k=n=0,i=u.length;n<i;k=++n)s=u[k],t.push(function(n){return function(t){return{name:t.name,index:t.name,formatter:n.columnFormatter(t,h,e,f),width:t.width||"",hidden:t.hidden!=null||r.hiddenColumns!=null&&~r.hiddenColumns.indexOf(t.name),sortable:t["sort-field"]!=null}}}(this)(s,k));return t}.call(this),datatype:"json",autowidth:!0,shrinkToFit:!1,ignoreCase:!0,sortable:!0,columnReordering:!0,footerrow:!1,userDataOnFooter:!1,search:f.filter!=null||r.filters!=null,height:"auto",viewrecords:!0,pager:f.paging!=null?y[0].id:void 0,rowNum:f.paging!=null?((et=f.paging)!=null?et.records:void 0)||10:void 0,rowList:f.paging!=null?((ot=f.paging)!=null?ot.options:void 0)||[10,20,30,40,50,100]:void 0,url:h==null?f.source:void 0,loadComplete:function(n){var i,u,f,t,h,s;for(i=o.jqGrid("getGridParam","selrow"),$(r).trigger("gridLoad",{id:i,data:o.getRowData(i),tableData:n}),f=o[0].rows,s=[],t=0,h=f.length;t<h;t++)u=f[t],ko.cleanNode(u),s.push(ko.applyBindings(e,u));return s},onSelectRow:function(n,t,i){return $(r).trigger("selectionChange",{id:n,data:o.getRowData(n),isSelected:t,event:i})}},f.loadDataOnStart==null&&(f.loadDataOnStart=!0),f.loadDataOnStart&&h!=null&&$.extend(c,{datatype:"jsonstring",datastr:{page:1,records:h.length,rows:h},jsonReader:{repeatitems:!1}}),f.loadDataOnStart||$.extend(c,{datatype:"local"}),f.defaultSort!=null&&$.extend(c,{sortname:f.defaultSort.field,sortorder:f.defaultSort.direction||"asc"}),f.tree!=null&&(f.tree===!0&&(f.tree={}),f.tree.columnName=ko.utils.arrayFirst(u,function(n){return n.hidden==null}).name,$.extend(c,{treeGrid:!0,ExpandColumn:f.tree.columnName,ExpandColClick:!0,treeGridModel:"adjacency",treeReader:{parent_id_field:f.tree.parent||"parent",expanded_field:f.tree.expanded||"expanded"}})),f.filter!=null){f.filter.subscribe!=null&&f.filter.subscribe(function(){return function(){return $(r).trigger("reload")}}(this));w=[];a=f.filter();for(l in a)p=$.isArray(a[l]),d=p?"in":"cn",h=p?JSON.stringify(a[l]):a[l],w.push({field:l,data:h,op:d});v={groupOp:"AND",rules:w};r.filters!=null&&v.rules.push.apply(v.rules,r.filters.toJqGridFilters().rules);$.extend(c,{postData:{filters:JSON.stringify(v)}})}else r.filters!=null&&$.extend(c,{postData:{filters:JSON.stringify(r.filters.toJqGridFilters())}});if(r.filters!=null&&r.filters.subscribe!=null&&r.filters.subscribe(function(){return function(){return $(r).trigger("reload")}}(this)),f.source.subscribe!=null&&f.source.subscribe(function(){return function(){return $(r).trigger("reload")}}(this)),f.rowattr!=null&&$.extend(c,{rowattr:f.rowattr}),f.sendAlso!=null)for(f.sendAlso.subscribe!=null&&f.sendAlso.subscribe(function(){return function(){return $(r).trigger("reload")}}(this)),c.postData===void 0&&(c.postData={}),tt=f.sendAlso(),nt=0,ft=tt.length;nt<ft;nt++)b=tt[nt],$.extend(c.postData,b);f.useBrandFilter!=null&&f.useBrandFilter===!0&&i.selectedBrandsIds.subscribe(function(){return function(){return $(r).trigger("reload")}}(this));f.useLicenseeFilter!=null&&f.useLicenseeFilter===!0&&i.selectedLicenseesIds.subscribe(function(){return function(){return $(r).trigger("reload")}}(this));f.multiselect!=null&&f.multiselect===!0&&$.extend(c,{multiselect:!0,onSelectAll:function(n,t){return $(r).trigger("selectAllChange",{ids:n,allSelected:t})}});o.jqGrid(c);r.gridParam=function(){return function(n,t){return t!=null?o.jqGrid("setGridParam",n,t):o.jqGrid("getGridParam",n)}}(this);r.getRowData=function(){return function(n){return o.jqGrid("getRowData",n)}}(this);r.showColumns=function(){return function(n){return o.showCol(n)}}(this);r.hideColumns=function(){return function(n){return o.hideCol(n)}}(this);r.setColumnTitle=function(){return function(n,t){return s=ko.utils.arrayFirst(u,function(t){return t.name===n}),s!=null?o.jqGrid("setLabel",s.name,s.title=t):void 0}}(this);$(r).on("reload",function(){var n,t,u,i;if(n={search:f.filter!=null||r.filters!=null,page:1},$(r)[0].gridData!=null?(h=$(r)[0].gridData,n.datatype="jsonstring",n.datastr={page:1,records:h.length,rows:h}):n.datatype="json",f.filter!=null){w=[];a=f.filter();for(l in a)p=$.isArray(a[l]),d=p?"in":"cn",h=p?JSON.stringify(a[l]):a[l],w.push({field:l,data:h,op:d});v={groupOp:"AND",rules:w};r.filters!=null&&v.rules.push.apply(v.rules,r.filters.toJqGridFilters().rules);n.postData={filters:JSON.stringify(v)}}else r.filters!=null&&(n.postData={filters:JSON.stringify(r.filters.toJqGridFilters())});if(f.sendAlso!=null)for(n.postData===void 0&&(n.postData={}),i=f.sendAlso(),t=0,u=i.length;t<u;t++)b=i[t],$.extend(n.postData,b);return o.jqGrid("setGridParam",n).trigger("reloadGrid")});return f.tree!=null&&($(".treeclick").each(function(){var n,t,i;return n=Number($(this).parent().next().find("span").attr("level")),i=$(this).closest("tr").next("tr").find(".treeclick"),t=Number(i.parent().next().find("span").attr("level")),t!==n+1?$(this).removeClass("treeclick"):void 0}),$(".treeclick.tree-minus",r).addClass("fa fa-caret-down"),$(".treeclick.tree-plus",r).addClass("fa fa-caret-right"),$(".treeclick").click(rt=function(){var t,n;return n=$(this).closest("td").find(".treeclick"),t=n.hasClass("tree-minus"),n.removeClass("fa-caret-down fa-caret-right").addClass(t?"fa-caret-down":"fa-caret-right")}).parent().next().click(rt)),f.paging!=null&&($(".ui-icon-seek-first",y).addClass("fa fa-angle-double-left bigger-140"),$(".ui-icon-seek-prev",y).addClass("fa fa-angle-left bigger-140"),$(".ui-icon-seek-next",y).addClass("fa fa-angle-right bigger-140"),$(".ui-icon-seek-end",y).addClass("fa fa-angle-double-right bigger-140"),$('<a class="btn btn-xs btn-round btn-primary"><i class="fa fa-refresh">').prependTo($("#"+y[0].id+"_left")).click(function(){return $(r).trigger("reload")})),f.useResizeManager!=null?(f.useResizeManager===!0&&(f.useResizeManager={}),r.id||(r.id="grid_"+Math.random().toString().substr(2)),function(i,r,u){var h,o,s,f;return h=t("ResizeManager"),f=null,o=e.compositionComplete,e.compositionComplete=function(){var t;return t=1<=arguments.length?n.call(arguments,0):[],o!=null&&o.call.apply(o,t),f=new h(r,i),u.height!=null&&(f.fixedHeight=u.height),f.$collapsible=$(u.collapsible),f.bindResize()},s=e.detached,e.detached=function(){var t;return t=1<=arguments.length?n.call(arguments,0):[],f.unbindResize(),s!=null&&s.call.apply(s,t),e.compositionComplete=o,e.detached=s}}(r.id,o[0].id,f.useResizeManager)):void 0},r.columnTitle=function(n){return(n||"").indexOf("app:")===0?t("i18next").t(n):n},r.columnFormatter=function(n,t,i,r){return function(u){return function(f,e,o){var y,h,c,l,s,a,p,v,w,b;if(s=o,o._id_!=null&&(s=ko.utils.arrayFirst(t,function(n){return typeof n=="object"&&n.id===o._id_}),s==null&&(s=t[Number(o._id_)-1])),r.fields!=null&&!s.fieldsMapped){for(v=r.fields,c=a=0,p=v.length;a<p;c=++a)y=v[c],s[y]=s[c];s.fieldsMapped=!0}return h=function(t,i,r){var f,o,e=$("<div>"+n.template.trim()+"<\/div>");for(f in n)o=n[f],f.indexOf("data-")===0&&e.attr(f,o);return u.evaluateElementValues(e,t,i,r),e.html()}(s,t,i),n.name===((w=r.tree)!=null?w.columnName:void 0)&&(l=s[((b=r.tree)!=null?b.level:void 0)||"level"],h="<span level='"+l+"' style='padding-right: 5px; padding-left: "+l*20+"px;'><\/span>"+h),h}}(this)},r.evaluateElementValues=function(n,t,i,r){var f,a,e,u,o,s,v,y,h,c,l;for(e="data-",h=ko.utils.arrayFilter(n[0].attributes,function(n){return n.name.indexOf(e)===0}),o=0,v=h.length;o<v;o++)f=h[o],u=this.evaluateExpression(f.value,t,i,r),u==null&&(u=""),f.name!==""+e+"value"?n.attr(f.name.substr(e.length),String(u)):n[0].tagName==="INPUT"?n.attr("type")==="checkbox"?n.attr("checked",Boolean(u)):n.val(String(u)):n.html(String(u));for(c=n.children().toArray(),l=[],s=0,y=c.length;s<y;s++)a=c[s],l.push(this.evaluateElementValues($(a),t,i,r));return l},r.evaluateExpression=function(n,t,i,r){var f,e,o;return o=window.$root,e=window.$parent,window.$root=r,window.$parent=i,f=u.eval.call(t,n),window.$root=o,window.$parent=e,f},r}()})}).call(this);