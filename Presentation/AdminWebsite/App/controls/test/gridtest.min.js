(function(){define(function(n){var u,t,i,r;return n("controls/grid"),r=n("shell"),i=n("nav"),t=n("i18next"),u=ko.computed(function(){var n;return n=r.brands(),n.shift(),n}),function(){function f(){this.shell=r;this.bonusId=ko.observable();this.bonusRemarks=ko.observable();this.isBonusActive=ko.observable(!1);this.search=ko.observable("");this.compositionComplete=function(n){return function(){return $(function(){$("#bonus-grid").on("gridLoad selectionChange",function(t,i){return n.bonusId(i.id),n.isBonusActive(i.data.IsActive==="Active"),n.bonusRemarks(i.data.Remarks)});return $("#bonus-search").submit(function(){return n.search($("#name-search").val()),!1})})}}(this)}return f.prototype.typeFormatter=function(){return t.t("app:bonus.bonusTypes."+(this.IsFirstDeposit&&this.Type===0?"FirstDeposit":this.Type))},f.prototype.brandFormatter=function(){var n;return n=ko.utils.arrayFirst(u(),function(n){return function(t){return t.id()===n.BrandId}}(this)),n!=null?n.name():void 0},f.prototype.statusFormatter=function(){return t.t("app:bonus.status."+this.IsActive)},f.prototype.openAddBonusTab=function(){return i.open({path:"bonus/bonus-manager/add-bonus",title:t.t("app:bonus.bonusManager.new")})},f.prototype.openEditBonusTab=function(){if(this.bonusId())return i.open({path:"bonus/bonus-manager/edit-bonus",title:t.t("app:bonus.bonusManager.edit"),data:{id:this.bonusId()}})},f.prototype.openViewBonusTab=function(){if(this.bonusId())return i.open({path:"bonus/bonus-manager/view-bonus",title:t.t("app:bonus.bonusManager.view"),data:{id:this.bonusId()}})},f.prototype.showModalDialog=function(t){var i;return i=n("bonus/bonus-manager/bonus-status-dialog"),console.log(this),new i(t,this.bonusRemarks()).show().then(function(n){return function(i){if(!i.isCancel)return $.post("/Bonus/ChangeBonusStatus",{id:n.bonusId(),isActive:t,remarks:i.remarks}).done(function(n){if(n.Success)return $("#bonus-grid").trigger("reload")})}}(this))},f}()})}).call(this);